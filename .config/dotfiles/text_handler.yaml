auto_select_max_threshold: 100
auto_select_min_threshold: 10
commands:
  ff_tab:
    display: "🌐 Open in Firefox Tab"
    command: firefox --new-tab "$TEXT"
  ff_window:
    display: "🗔 Open in New Firefox Window"
    command: firefox --new-window "$TEXT"
  tsp_ytdlp:
    display: "⬇️ Download with tsp_ytdlp"
    command: tsp_ytdlp "$TEXT"
  tsp_ytdlp_batch:
    display: "⬇️ Batch Download with tsp_ytdlp"
    command: 'echo "$TEXT" | while IFS= read -r url; do [ -n "$url" ] && tsp_ytdlp "$url"; done'
  mvx:
    display: "🚚 mv file 🐻"
    command: st -g 100x20+2000+720 -c "stfuzzy" -e sh -c 'mvx --notify-send --dir "$HOME" --file "$TEXT"; exit 0'
  gallery-dl:
    display: "🖼️ Download with gallery-dl"
    command: stcmd "gallery-dl $TEXT"
  rss:
    display: "📰 Add as newsboat feed"
    command: echo "$TEXT" >> ~/.config/newsboat/urls && notify-send "Added feed to newsboat"
  watch_mpv:
    display: "🎬 Watch video in mpv"
    command: stcmd "mpv $TEXT"
  magnet_link:
    display: "🏴‍☠️ Add torrent"
    command: ~/.config/dotfiles/handlers/magnet_link_handler.sh "$TEXT"
  xdg-open:
    display: "📄 Open file with xdg-open"
    command: xdg-open "$TEXT"
  st_dir:
    display: "📂 Open directory in terminal"
    command: 'TEXT="${TEXT/#~/$HOME}" && [ -d "$TEXT" ] && st -e sh -c "cd \"$TEXT\" && exec \$SHELL" || st -e sh -c "cd \"$(dirname \"$TEXT\")\" && exec \$SHELL"'
  pcmanfm_dir:
    display: "📂 Open directory in file manager"
    command: 'TEXT="${TEXT/#~/$HOME}" && [ -d "$TEXT" ] && pcmanfm "$TEXT" || pcmanfm "$(dirname "$TEXT")"'
  nvim_text:
    display: "📝 Open text in Nvim"
    command: stcmd "printf '%s' \"$TEXT\" | nvim -; exit"
  nvim_file:
    display: "📝 Open file in Nvim"
    command: stcmd "nvim \"$TEXT\"; exit"
  dragon_drop:
    display: "🐲 Dragon drop"
    command: 'TEXT="${TEXT/#~/$HOME}" && if [ -d "$TEXT" ]; then dragon-drag-and-drop "$TEXT"/*; else dragon-drag-and-drop "$TEXT"; fi'
  qr_code:
    display: "📸 Generate QR code"
    command: qrencode -t PNG -o /tmp/qr.png < "$DATA_FILE" && feh /tmp/qr.png && rm /tmp/qr.png
  dragon_drop_file:
    display: "🐲🖼️ Dragon drop File📁"
    command: |
      cp "$DATA_FILE" /tmp/text_handler_file
      dragon-drag-and-drop /tmp/text_handler_file


scorers:
  - regex: '^https?://.*'
    command_label: ff_tab
    score_change: 11
  - regex: '^https?://.*'
    command_label: tsp_ytdlp
    score_change: 1
  - regex: '^https?://.*(?:video|view).*'
    command_label: tsp_ytdlp
    score_change: 20
  - regex: '^(?:https?://.*(?:\n|$)){2,}$'
    command_label: tsp_ytdlp_batch
    score_change: 30
  - regex: '^https?://.*'
    command_label: ff_window
    score_change: 10
  - regex: 'youtube\.com|youtu\.be|twitch\.tv'
    command_label: tsp_ytdlp
    score_change: 20
  - regex: 'instagram\.com|twitter\.com|x\.com'
    command_label: gallery-dl
    score_change: 20
  - regex: '\.rss$|feeds\.xml|/feed'
    command_label: rss
    score_change: 25
  - regex: '^magnet:\?'
    command_label: magnet_link
    score_change: 150
  - regex: '\.(txt|md|rs|py|js|html|css)$'
    command_label: xdg-open
    score_change: 20
  - regex: '\S'
    score_change: 1
    command_label: nvim_text
  - regex: ^https?://www\.youtube\.com/watch
    command_label: tsp_ytdlp
    score_change: 10
  - regex: '^\S+$'
    command_label: qr_code
    score_change: 5
  - regex: '^/.*'
    command_label: qr_code
    score_change: -100
  - regex: '^https?://.*'
    command_label: qr_code
    score_change: -100
  - regex: '^magnet:\?'
    command_label: qr_code
    score_change: -100
  - regex: '^~/([^/\s]*/?)*$'
    command_label: st_dir
    score_change: 10
  - regex: '^~/([^/\s]*/?)*$'
    command_label: pcmanfm_dir
    score_change: 10
  - regex: '^(/[^/\s]*)+/?$'
    command_label: st_dir
    score_change: 5
  - regex: '^(/[^/\s]*)+/?$'
    command_label: pcmanfm_dir
    score_change: 5
  - regex: '^(/[^/\s]*)+/?$'
    command_label: dragon_drop
    score_change: 5
  - regex: '^~/([^/\s]*/?)*$'
    command_label: dragon_drop
    score_change: 5
  - regex: 'image/png'
    command_label: dragon_drop_file
    score_change: 25
  - regex: '^[a-z]+/[a-z0-9+.-]+$'
    command_label: nvim_text
    score_change: -2
  - command: '[ -f "$TEXT" ] || [ -d "$TEXT" ]'
    command_label: mvx
    score_change: 10
  - command: '[ -f "$TEXT" ] && ([ ! -s "$TEXT" ] || grep -qI . "$TEXT" 2>/dev/null)'
    scores:
      - ["nvim_file", 10]
      - ["nvim_text", -2]
  - command: '[ -f "$TEXT" ] && ! grep -qI . "$TEXT" 2>/dev/null'
    command_label: nvim_text
    score_change: -2
