polkit.addRule(function(action, subject) {
    if ((action.id == "org.freedesktop.systemd1.manage-units" ||
         action.id == "org.freedesktop.policykit.exec") &&
        action.lookup("program") == "/usr/bin/systemctl" &&
        subject.isInGroup("wheel")) {
        
        var verb = action.lookup("verb");
        var unit = action.lookup("unit");
        
        if ((verb == "start" || verb == "stop") && 
            unit && unit.indexOf("wg-quick@") == 0) {
            return polkit.Result.YES;
        }
    }
});
